<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Submit a recipe</title>
    </head>

    <body>
    	{% load static %}
    	<script src="{% static 'recipes/ingredient_form_script.js' %}"></script>

        {% if request.user.is_authenticated %}

    	  <div>
    		    <h2>Submit a link to a recipe ...</h2><br>
    		    {% if error_message_link %}
				    <div>
				        Error : {{error_message_link}} <br>
				        {% if existing_recipe %}
					      <a href="/recipes/{{ existing_recipe.id }}/">Link towards the recipe</a><br>
				        {% endif %}
				    </div>
			      {% endif %}
    		    <form method="post" action="{% url 'recipes:scrape' %}">
		            {% csrf_token %}
		            <input type="text" id="url" name="url" placeholder="https://www.cuisine-libre.org/potee-auvergnate">
                <input type="submit" value="Submit">
            </form>
    	  </div>

    	  <div>
		        <h2>... Or write your own recipe</h2>
		        {% if error_message_form %}
				    <div>
				        Error : {{error_message_form}} <br>

				        {% if existing_recipe %}
					      <a href="/recipes/{{ existing_recipe.id }}/">Link towards the recipe</a><br>
				        {% endif %}

				    </div>
			      {% endif %}
		        <form method="post" action="{% url 'recipes:handle_form' %}">
		            {% csrf_token %}
		            <table>
		            	{{ form.as_table }}
		            
			        	<datalist id= "ingredients_list">
						    <option value=""> None </option>
								{% for ingredient in ingredient_list %}
								  <option value="{{ ingredient }}"> {{ ingredient }} </option>
								{% endfor %}
					  	</datalist>
					  	<tbody>
					  		<th> Ingredients </th>
					    	<table id="ingredient_input">
								<script> addIngredient() </script>
						    </table>
						    <tr>
						    	<button type="button" onclick=addIngredient() >Add ingredient</button><br>
						    <tr>
						</tbody>
				    </table>
		            <input type="submit" value="Submit my recipe">
		        </form>
		    </div>

        {% else %}

        <p>You need to <a href="{% url 'login' %}?next={{request.path}}">log in</a> to perform this action </p>

        {% endif %}
    </body>
</html>
